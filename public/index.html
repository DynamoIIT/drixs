<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta http-equiv="Cache-Control" content="no-cache, no-store, must-revalidate">
    <meta http-equiv="Pragma" content="no-cache">
    <meta http-equiv="Expires" content="0">
    <title>DRIXS - Ultimate Chat Experience</title>
    <link rel="stylesheet" href="style.css?v=2.0">
    <link rel="stylesheet" href="style_profiles.css?v=2.0">
    <link
        href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;700;900&family=Rajdhani:wght@300;400;500;600;700&family=Exo+2:wght@100;200;300;400;500;600;700;800;900&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Cropper.js -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/cropperjs/1.5.13/cropper.min.js"></script>
</head>

<body>
    <!-- Animated Background Effects -->
    <div class="bg-effects">
        <div class="floating-orbs">
            <div class="orb orb-1"></div>
            <div class="orb orb-2"></div>
            <div class="orb orb-3"></div>
            <div class="orb orb-4"></div>
            <div class="orb orb-5"></div>
        </div>
        <div class="grid-overlay"></div>
        <div class="particle-field"></div>
    </div>

    <!-- Welcome Screen -->
    <div id="welcomeScreen" class="welcome-screen active">
        <div class="welcome-container">
            <div class="logo-section">
                <div class="logo-glow"></div>
                <h1 class="main-title">
                    <span class="title-line">WELCOME</span>
                    <span class="title-line">TO</span>
                    <span class="title-line brand">DRIXS</span>
                </h1>
                <div class="subtitle">Where Conversations Come Alive</div>
            </div>

            <div class="input-section" id="authSection">
                <!-- Auth Options Container -->
                <div id="authOptionsContainer">
                    <!-- Standard Login Button -->
                    <div id="standardLoginContainer">
                        <button id="showLoginBtn" class="start-btn ready"
                            style="background: transparent; margin-bottom: 20px;">
                            <div class="btn-bg" style="background: linear-gradient(45deg, #00C9FF, #92FE9D);"></div>
                            <div class="btn-glow" style="background: linear-gradient(45deg, #00C9FF, #92FE9D);"></div>
                            <span class="btn-text">
                                <i class="fas fa-sign-in-alt"></i>
                                LOG IN
                            </span>
                        </button>
                    </div>

                    <!-- Google Login Button -->
                    <div id="googleLoginContainer">
                        <button id="googleLoginBtn" class="start-btn ready">
                            <div class="btn-bg"></div>
                            <div class="btn-glow"></div>
                            <span class="btn-text">
                                <i class="fab fa-google"></i>
                                CONTINUE WITH GOOGLE
                            </span>
                            <div class="btn-particles"></div>
                        </button>
                    </div>
                </div>

                <!-- Standard Login Form (Hidden initially) -->
                <div id="loginFormContainer" style="display: none;">
                    <div class="input-container">
                        <div class="input-glow"></div>
                        <input type="text" id="loginUsernameInput" placeholder="Username" maxlength="20"
                            autocomplete="off">
                        <div class="input-border"></div>
                    </div>

                    <div class="input-container">
                        <div class="input-glow"></div>
                        <input type="password" id="loginPasswordInput" placeholder="Password" maxlength="50"
                            autocomplete="off">
                        <div class="input-border"></div>
                    </div>

                    <button id="loginSubmitBtn" class="start-btn" disabled>
                        <div class="btn-bg"></div>
                        <div class="btn-glow"></div>
                        <span class="btn-text">
                            <i class="fas fa-arrow-right"></i>
                            LOG IN
                        </span>
                    </button>

                    <button id="backToOptionsBtn" class="text-btn"
                        style="background: none; border: none; color: rgba(255,255,255,0.6); margin-top: 15px; cursor: pointer; font-family: 'Rajdhani', sans-serif;">
                        <i class="fas fa-arrow-left"></i> Back
                    </button>
                </div>

                <!-- Profile Setup Form (Hidden initially) -->
                <!-- Profile Setup Form (Wizard) -->
                <div id="profileSetupContainer" style="display: none;">

                    <!-- Wizard Progress -->
                    <div class="wizard-progress">
                        <div class="step-dot active" data-step="1">1</div>
                        <div class="step-line"></div>
                        <div class="step-dot" data-step="2">2</div>
                        <div class="step-line"></div>
                        <div class="step-dot" data-step="3">3</div>
                        <div class="step-line"></div>
                        <div class="step-dot" data-step="4">4</div>
                    </div>

                    <!-- Step 1: Username -->
                    <div class="wizard-step active" id="wizardStep1" style="display: block;">
                        <h2>Choose Your Alias</h2>
                        <p>This is how others will see you.</p>

                        <div class="input-container">
                            <div class="input-glow"></div>
                            <input type="text" id="newUsernameInput" placeholder="Enter username..." maxlength="20"
                                autocomplete="off">
                            <div class="input-border"></div>
                        </div>

                        <div class="wizard-nav">
                            <button class="next-btn" onclick="nextWizardStep(2)">Next <i
                                    class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- Step 2: Password -->
                    <div class="wizard-step" id="wizardStep2" style="display: none;">
                        <h2>Secure Your Comms</h2>
                        <p>Set a password for manual login.</p>

                        <div class="input-container">
                            <div class="input-glow"></div>
                            <input type="password" id="newPasswordInput" placeholder="Enter password..." maxlength="50"
                                autocomplete="off">
                            <div class="input-border"></div>
                        </div>

                        <div class="wizard-nav">
                            <button class="back-btn" onclick="nextWizardStep(1)">Back</button>
                            <button class="next-btn" onclick="nextWizardStep(3)">Next <i
                                    class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- Step 3: Bio -->
                    <div class="wizard-step" id="wizardStep3" style="display: none;">
                        <h2>Your Story</h2>
                        <p>Briefly describe your persona.</p>

                        <div class="input-container textarea-container">
                            <div class="input-glow"></div>
                            <textarea id="newUserBioInput" placeholder="Write something..." maxlength="150"
                                rows="3"></textarea>
                            <div class="input-border"></div>
                        </div>

                        <div class="wizard-nav">
                            <button class="back-btn" onclick="nextWizardStep(2)">Back</button>
                            <button class="next-btn" onclick="nextWizardStep(4)">Next <i
                                    class="fas fa-arrow-right"></i></button>
                        </div>
                    </div>

                    <!-- Step 4: Avatar -->
                    <div class="wizard-step" id="wizardStep4" style="display: none;">
                        <h2>Upload Avatar</h2>
                        <p>Show your face (or not).</p>

                        <div class="profile-pic-upload-section">
                            <label for="profilePicInput" class="profile-pic-label" id="profilePicLabel">
                                <div class="profile-pic-preview-container">
                                    <img id="setupProfilePicPreview"
                                        src="https://ui-avatars.com/api/?name=User&background=random"
                                        alt="Profile Preview">
                                    <div class="upload-overlay">
                                        <i class="fas fa-camera"></i>
                                    </div>
                                </div>
                                <span>Click to upload photo</span>
                            </label>
                            <input type="file" id="profilePicInput" accept="image/*" style="display: none;">
                            <button id="skipPicBtn" class="skip-btn" style="margin-top: 10px;">Skip for now</button>
                        </div>

                        <div class="wizard-nav" style="flex-direction: column; align-items: center;">
                            <button id="createAccountBtn" class="start-btn">
                                <div class="btn-bg"></div>
                                <div class="btn-glow"></div>
                                <span class="btn-text">FINISH & CREATE</span>
                            </button>
                            <button class="back-btn" onclick="nextWizardStep(3)"
                                style="background: none; border: none; font-size: 0.9em; margin-top: 10px;">Back</button>
                        </div>
                    </div>
                </div>
            </div>

            <div class="features-preview">
                <div class="feature-item">
                    <i class="fas fa-users"></i>
                    <span>Real-time Chat</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-robot"></i>
                    <span>AI Assistant</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-lock"></i>
                    <span>DMs</span>
                </div>
                <div class="feature-item">
                    <i class="fas fa-pencil"></i>
                    <span>Posts</span>
                </div>
                <!-- Elite Mode Section -->
                <div class="elite-mode-section">
                    <div class="elite-divider">
                        <span class="elite-text">ENTER ELITE MODE</span>
                    </div>

                    <div class="elite-login" id="eliteLogin">
                        <div class="elite-input-container">
                            <div class="elite-input-glow"></div>
                            <input type="text" id="developerUsername" placeholder="Official's Username" maxlength="20"
                                autocomplete="off">
                        </div>

                        <div class="elite-input-container">
                            <div class="elite-input-glow"></div>
                            <input type="password" id="developerPassword" placeholder="Password" maxlength="50"
                                autocomplete="off">
                        </div>

                        <button id="eliteLoginBtn" class="elite-btn" disabled>
                            <div class="elite-btn-bg"></div>
                            <span class="elite-btn-text">
                                <i class="fas fa-crown"></i>
                                ACCESS GRANTED
                            </span>
                        </button>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Chat Screen -->
    <div id="chatScreen" class="chat-screen">
        <!-- Chat Header -->
        <div class="chat-header">
            <div class="header-bg"></div>
            <div class="header-content">
                <div class="logo-mini">
                    <span class="logo-text">DRIXS</span>
                    <div class="logo-pulse"></div>
                </div>

                <!-- Centered Controls Area -->
                <div class="center-controls">
                    <!-- Regular User Hamburger Button -->
                    <div class="regular-user-controls" id="regularUserControls">
                        <button class="user-hamburger-btn" id="userHamburgerBtn">
                            <div class="hamburger-line"></div>
                            <div class="hamburger-line"></div>
                            <div class="hamburger-line"></div>
                        </button>
                    </div>

                    <!-- Developer Hamburger Menu -->
                    <div class="developer-controls" id="developerControls" style="display: none;">
                        <button class="hamburger-btn" id="hamburgerBtn">
                            <div class="hamburger-line"></div>
                            <div class="hamburger-line"></div>
                            <div class="hamburger-line"></div>
                        </button>
                    </div>
                </div>

                <!-- Right-aligned Controls -->
                <div class="right-controls">
                    <div class="bulb-container" id="bulbContainer">
                        <button class="bulb-btn" id="bulbBtn">
                            <div class="bulb-icon">
                                <div class="bulb-glass"></div>
                                <div class="bulb-filament"></div>
                                <div class="bulb-base"></div>
                            </div>
                        </button>
                    </div>

                    <div class="theme-toggle-container">
                        <button class="theme-toggle-btn" id="themeToggleBtn">
                            <div class="theme-btn-glow"></div>
                            <i class="fas fa-sun theme-icon" id="themeIcon"></i>
                            <div class="theme-particles"></div>
                        </button>
                    </div>

                    <div class="online-counter">
                        <div class="counter-bg"></div>
                        <div class="online-indicator">
                            <div class="blink-dot"></div>
                        </div>
                        <span id="onlineCount">0</span>
                        <span class="counter-text">Online</span>
                    </div>
                </div>
            </div>
        </div>

        <!-- Chat Messages Area -->
        <div class="chat-messages" id="chatMessages">
            <!-- Messages will be inserted here dynamically -->
        </div>

        <!-- Scroll to Bottom Button -->
        <button class="scroll-to-bottom-btn" id="scrollToBottomBtn" style="display: none;">
            <i class="fas fa-chevron-down"></i>
        </button>

        <!-- Typing Indicators -->
        <div class="typing-indicators" id="typingIndicators"></div>

        <!-- Message Input Area -->
        <div class="message-input-area">
            <div class="input-bg"></div>
            <div class="message-reply-preview" id="replyPreview"></div>

            <div class="input-wrapper">
                <div class="emoji-btn" id="emojiBtn">
                    <i class="fas fa-smile"></i>
                </div>

                <div class="message-input-container">
                    <textarea id="messageInput" placeholder="Type your message... (Use /ai for AI chat)" rows="1"
                        maxlength="500"></textarea>
                    <div class="input-effects"></div>
                </div>

                <button id="sendBtn" class="send-btn">
                    <div class="send-bg"></div>
                    <i class="fas fa-paper-plane"></i>
                    <div class="send-ripple"></div>
                </button>
            </div>
        </div>

        <!-- AI Chat Modal -->
        <div class="ai-modal" id="aiModal">
            <div class="ai-modal-content">
                <div class="ai-header">
                    <div class="ai-avatar">
                        <i class="fas fa-robot"></i>
                        <div class="ai-pulse"></div>
                    </div>
                    <h3>AI Assistant</h3>
                    <button class="ai-close" id="aiCloseBtn">
                        <i class="fas fa-times"></i>
                    </button>
                </div>
                <div class="ai-messages" id="aiMessages"></div>
            </div>
        </div>
    </div>

    <!-- Notification Container -->
    <div class="notification-container" id="notificationContainer"></div>

    <!-- Reaction Picker -->
    <div class="reaction-picker" id="reactionPicker">
        <div class="picker-bg"></div>
        <div class="reaction-grid">
            <span class="reaction-emoji" data-emoji="‚ù§Ô∏è">‚ù§Ô∏è</span>
            <span class="reaction-emoji" data-emoji="üòÇ">üòÇ</span>
            <span class="reaction-emoji" data-emoji="üòÆ">üòÆ</span>
            <span class="reaction-emoji" data-emoji="üò¢">üò¢</span>
            <span class="reaction-emoji" data-emoji="üò°">üò°</span>
            <span class="reaction-emoji" data-emoji="üëç">üëç</span>
            <span class="reaction-emoji" data-emoji="üëé">üëé</span>
            <span class="reaction-emoji" data-emoji="üî•">üî•</span>
        </div>
        <button class="reply-btn" id="replyBtn">
            <i class="fas fa-reply"></i>
            Reply
        </button>
    </div>

    <!-- Loading Screen -->
    <div class="loading-screen" id="loadingScreen">
        <div class="loading-content">
            <div class="loading-spinner">
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
                <div class="spinner-ring"></div>
            </div>
            <div class="loading-text">Connecting to DRIXS...</div>
        </div>
    </div>

    <!-- Developer Panel -->
    <div class="developer-panel" id="developerPanel">
        <div class="panel-content">
            <div class="panel-header">
                <h3><i class="fas fa-shield-alt"></i> Developer Panel</h3>
                <button class="panel-close" id="panelCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="online-users-list" id="onlineUsersList">
                <!-- Users will be populated here -->
            </div>
        </div>
    </div>

    <!-- DM Windows Container -->
    <div class="dm-windows-container" id="dmWindowsContainer">
        <!-- DM windows will be dynamically created here -->
    </div>

    <!-- REPLACE the existing Regular User Hamburger Menu section (around line 190-210) with this: -->

    <!-- Regular User Hamburger Menu - Updated Structure -->
    <div class="user-hamburger-menu" id="userHamburgerMenu">
        <div class="hamburger-content">
            <div class="hamburger-header">
                <h3><i class="fas fa-bars"></i> DRIXS</h3>
                <button class="hamburger-close" id="userHamburgerClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>

            <!-- Gen-Z Style Container Grid - UPDATED WITH GAMES -->
            <!-- Full-Width Online Users Bar -->
            <div class="online-users-bar" id="openOnlineListBtn">
                <div class="bar-icon"><i class="fas fa-users"></i></div>
                <div class="bar-info">
                    <span class="bar-title">ONLINE USERS</span>
                    <span class="bar-count" id="onlineCountBadge">0 Online</span>
                </div>
                <div class="bar-arrow"><i class="fas fa-chevron-right"></i></div>
            </div>

            <div class="genz-container-grid">
                <div class="genz-container" id="gamesContainer">
                    <div class="genz-header">
                        <i class="fas fa-gamepad"></i>
                        <span>GAMES</span>
                    </div>
                    <div class="games-mini-list">
                        <div class="game-btn-mini" id="ticTacToeGame" title="Tic-Tac-Toe">
                            <i class="fas fa-times"></i>
                        </div>
                    </div>
                </div>

                <div class="genz-container" id="postsContainer">
                    <div class="genz-header">
                        <i class="fas fa-newspaper"></i>
                        <span>POSTS</span>
                    </div>
                    <div class="posts-preview">
                        <p>Trending</p>
                    </div>
                </div>

                <!-- Settings Section -->
                <div class="genz-container" id="settingsMenuContainer">
                    <div class="genz-header">
                        <i class="fas fa-cog"></i>
                        <span>SETTINGS</span>
                    </div>
                    <div class="settings-options">
                        <div class="setting-item" id="editProfileBtn">
                            <i class="fas fa-user-edit"></i>
                            <span>Profile</span>
                        </div>
                        <div class="setting-item logout" id="logoutBtn">
                            <i class="fas fa-sign-out-alt"></i>
                            <span>Logout</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>

    <!-- Posts Window -->
    <div class="posts-window" id="postsWindow">
        <div class="posts-header">
            <button class="posts-back-btn" id="postsBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2>POSTS</h2>
            <div class="posts-controls">
                <button class="posts-refresh-btn" id="postsRefreshBtn" title="Refresh">
                    <i class="fas fa-sync-alt"></i>
                </button>
                <button class="posts-home-btn" id="postsHomeBtn" title="Home">
                    <i class="fas fa-home"></i>
                </button>
                <button class="posts-create-btn" id="postsCreateBtn" title="Create Post">
                    <i class="fas fa-pencil-alt"></i>
                </button>
            </div>
        </div>

        <!-- Posts Navigation -->
        <div class="posts-navigation">
            <button class="posts-nav-btn active" id="featuredPostsBtn">FEATURED</button>
            <button class="posts-nav-btn" id="myPostsBtn">MY POSTS</button>
        </div>

        <!-- Posts Feed -->
        <div class="posts-feed" id="postsFeed">
            <!-- Posts will be loaded here -->
        </div>
    </div>

    <!-- Create Post Window -->
    <div class="create-post-window" id="createPostWindow">
        <div class="create-post-header">
            <button class="create-back-btn" id="createBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2>CREATE POST</h2>
        </div>

        <div class="create-post-form">
            <textarea id="postContent" placeholder="What's on your mind..." maxlength="500"></textarea>

            <div class="post-image-section">
                <label for="postImageInput" class="image-upload-btn">
                    <i class="fas fa-image"></i>
                    <span>Attach Image</span>
                </label>
                <input type="file" id="postImageInput" accept="image/*" style="display: none;">
                <div class="image-preview" id="imagePreview"></div>
            </div>

            <div class="create-post-actions">
                <button class="cancel-post-btn" id="cancelPostBtn">CANCEL</button>
                <button class="publish-post-btn" id="publishPostBtn">PUBLISH</button>
            </div>
        </div>
    </div>

    <!-- Comments Window -->
    <div class="comments-window" id="commentsWindow">
        <div class="comments-header">
            <button class="comments-back-btn" id="commentsBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2>COMMENTS</h2>
        </div>

        <!-- Original Post Display -->
        <div class="original-post" id="originalPost">
            <!-- Original post will be displayed here -->
        </div>

        <!-- Comments Section -->
        <div class="comments-section" id="commentsSection">
            <!-- Comments will be loaded here -->
        </div>

        <!-- Add Comment -->
        <div class="add-comment-section">
            <div class="comment-input-wrapper">
                <textarea id="commentInput" placeholder="Add a comment..." rows="2" maxlength="300"></textarea>
                <button class="send-comment-btn" id="sendCommentBtn">
                    <i class="fas fa-paper-plane"></i>
                </button>
            </div>
        </div>
    </div>

    <!-- Edit Post Modal -->
    <div class="edit-post-modal" id="editPostModal">
        <div class="edit-post-content">
            <div class="edit-post-header">
                <h3>Edit Post</h3>
                <button class="edit-close-btn" id="editCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="edit-post-body">
                <textarea id="editPostContent" maxlength="500"></textarea>
                <div class="edit-post-actions">
                    <button class="edit-cancel-btn" id="editCancelBtn">Cancel</button>
                    <button class="edit-save-btn" id="editSaveBtn">Save Changes</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Warn Modal -->
    <div class="warn-modal" id="warnModal">
        <div class="warn-modal-content">
            <div class="warn-header">
                <h3><i class="fas fa-exclamation-triangle"></i> Warning</h3>
                <button class="warn-close" id="warnCloseBtn">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="warn-body">
                <p>Warning user: <span id="warnUserName"></span></p>
                <textarea id="warnReason" placeholder="Enter warning reason..." maxlength="200"></textarea>
                <div class="warn-actions">
                    <button id="sendWarnBtn" class="warn-send-btn">Send Warning</button>
                    <button id="cancelWarnBtn" class="warn-cancel-btn">Cancel</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Custom Confirm Modal -->
    <div class="custom-modal" id="confirmModal">
        <div class="confirm-modal-content">
            <div class="confirm-header">
                <h3><i class="fas fa-question-circle"></i> REQUEST</h3>
            </div>
            <div class="confirm-body">
                <p id="confirmMessage">Are you sure you want to proceed?</p>
                <div class="confirm-actions">
                    <button id="confirmYesBtn" class="confirm-yes-btn">YES</button>
                    <button id="confirmNoBtn" class="confirm-no-btn">NO</button>
                </div>
            </div>
        </div>
    </div>

    <!-- Phonk audio fallback (optional, if needed for some browsers) -->
    <audio id="phonkAudio" src="phonk.mp3" preload="auto"></audio>
    <!-- TIC-TAC-TOE GAME WINDOWS -->

    <!-- Opponent Selection Window -->
    <div class="ttt-opponent-window" id="tttOpponentWindow">
        <div class="ttt-opponent-header">
            <button class="ttt-back-btn" id="tttOpponentBackBtn">
                <i class="fas fa-arrow-left"></i>
            </button>
            <h2>Choose Your Opponent</h2>
        </div>
        <div class="ttt-opponent-list" id="tttOpponentList">
            <!-- Opponents will be loaded here -->
        </div>
    </div>

    <!-- Challenge Popup (appears for challenged user) -->
    <div class="ttt-challenge-popup" id="tttChallengePopup">
        <div class="challenge-popup-content">
            <div class="challenge-progress-bar">
                <div class="challenge-progress-fill"></div>
            </div>
            <div class="challenge-icon">
                <i class="fas fa-gamepad"></i>
            </div>
            <div class="challenge-text">
                <strong id="challengerName">Player</strong> challenged you for X-O!
            </div>
            <div class="challenge-actions">
                <button class="challenge-accept-btn" id="challengeAcceptBtn">
                    <i class="fas fa-check"></i> Accept
                </button>
                <button class="challenge-decline-btn" id="challengeDeclineBtn">
                    <i class="fas fa-times"></i> Decline
                </button>
            </div>
        </div>
    </div>

    <!-- Tic-Tac-Toe Game Window -->
    <div class="ttt-game-window" id="tttGameWindow">
        <div class="ttt-game-header">
            <div class="ttt-player-info">
                <div class="ttt-player">
                    <div class="ttt-player-avatar" id="tttPlayer1Avatar"></div>
                    <div class="ttt-player-name" id="tttPlayer1Name">Player 1</div>
                    <div class="ttt-player-symbol" id="tttPlayer1Symbol">X</div>
                </div>
                <div class="ttt-vs">VS</div>
                <div class="ttt-player">
                    <div class="ttt-player-avatar" id="tttPlayer2Avatar"></div>
                    <div class="ttt-player-name" id="tttPlayer2Name">Player 2</div>
                    <div class="ttt-player-symbol" id="tttPlayer2Symbol">O</div>
                </div>
            </div>
            <button class="ttt-exit-btn" id="tttExitBtn">
                <i class="fas fa-times"></i>
            </button>
        </div>

        <div class="ttt-game-content">
            <div class="ttt-turn-indicator" id="tttTurnIndicator">
                Your Turn!
            </div>

            <div class="ttt-board" id="tttBoard">
                <div class="ttt-cell" data-index="0"></div>
                <div class="ttt-cell" data-index="1"></div>
                <div class="ttt-cell" data-index="2"></div>
                <div class="ttt-cell" data-index="3"></div>
                <div class="ttt-cell" data-index="4"></div>
                <div class="ttt-cell" data-index="5"></div>
                <div class="ttt-cell" data-index="6"></div>
                <div class="ttt-cell" data-index="7"></div>
                <div class="ttt-cell" data-index="8"></div>
            </div>
        </div>
    </div>

    <!-- Game Result Window -->
    <div class="ttt-result-window" id="tttResultWindow">
        <div class="ttt-result-content">
            <div class="ttt-result-animation" id="tttResultAnimation"></div>
            <div class="ttt-result-message" id="tttResultMessage">You Won!</div>
            <div class="ttt-result-actions">
                <button class="ttt-replay-btn" id="tttReplayBtn">
                    <i class="fas fa-redo"></i> Play Again
                </button>
                <button class="ttt-home-btn" id="tttResultHomeBtn">
                    <i class="fas fa-home"></i> Home
                </button>
            </div>
        </div>
    </div>

    <!-- Replay Request Popup -->
    <div class="ttt-replay-popup" id="tttReplayPopup">
        <div class="replay-popup-content">
            <div class="replay-icon">
                <i class="fas fa-redo"></i>
            </div>
            <div class="replay-text">
                <strong id="replayRequesterName">Player</strong> wants another round!
            </div>
            <div class="replay-actions">
                <button class="replay-accept-btn" id="replayAcceptBtn">
                    <i class="fas fa-check"></i> Accept
                </button>
                <button class="replay-decline-btn" id="replayDeclineBtn">
                    <i class="fas fa-times"></i> Decline
                </button>
            </div>
        </div>
    </div>

    <!-- Opponent Left Popup -->
    <div class="ttt-left-popup" id="tttLeftPopup">
        <div class="left-popup-content">
            <div class="left-icon">
                <i class="fas fa-door-open"></i>
            </div>
            <div class="left-text">
                <strong id="leftPlayerName">Player</strong> has left the game
            </div>
            <button class="left-ok-btn" id="leftOkBtn">
                <i class="fas fa-check"></i> OK
            </button>
        </div>
    </div>


    <!-- User Profile View Modal -->
    <div class="profile-view-modal" id="userProfileModal">
        <div class="profile-modal-content">
            <div class="profile-modal-banner"></div>
            <button class="profile-modal-close" id="profileModalClose">
                <i class="fas fa-times"></i>
            </button>
            <div class="profile-modal-body">
                <div class="profile-pic-wrapper">
                    <div class="profile-pic-glow"></div>
                    <img id="viewProfilePic" src="" alt="Profile Pic">
                </div>
                <h2 id="viewProfileUsername">Username</h2>
                <span class="profile-view-status">Online now</span>
                <div class="profile-bio-container">
                    <p id="viewProfileBio">Write something about uh.</p>
                </div>
            </div>
        </div>
    </div>

    <!-- Settings Modal -->
    <div class="settings-modal" id="settingsModal">
        <div class="settings-modal-content">
            <div class="settings-header">
                <h3><i class="fas fa-cog"></i> SETTINGS</h3>
                <button class="settings-close" id="settingsModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="settings-body">
                <div class="edit-profile-pic-section">
                    <div class="edit-pic-container">
                        <img id="editProfilePicPreview" src="" alt="Profile Preview">
                        <label for="editProfilePicInput" class="edit-pic-overlay">
                            <i class="fas fa-camera"></i>
                        </label>
                    </div>
                    <input type="file" id="editProfilePicInput" accept="image/*" style="display: none;">
                    <p>Change Profile Photo</p>
                </div>

                <div class="input-group">
                    <label>Username</label>
                    <div class="input-container">
                        <input type="text" id="editUsernameInput" maxlength="20">
                        <div class="input-border"></div>
                    </div>
                </div>

                <div class="input-group">
                    <label>Bio</label>
                    <div class="input-container textarea-container">
                        <textarea id="editBioInput" maxlength="150" rows="3"></textarea>
                        <div class="input-border"></div>
                    </div>
                </div>

                <button id="saveProfileBtn" class="save-btn">
                    <div class="btn-bg"></div>
                    <span>SAVE CHANGES</span>
                </button>
            </div>
        </div>
    </div>


    <!-- Online Users Detailed Modal -->
    <div class="online-list-modal" id="onlineUsersModal">
        <div class="online-modal-content">
            <div class="online-header">
                <h3><i class="fas fa-users"></i> ONLINE NOW</h3>
                <button id="closeOnlineModal"><i class="fas fa-times"></i></button>
            </div>
            <div class="online-body">
                <div class="online-search-bar">
                    <i class="fas fa-search"></i>
                    <input type="text" id="userListSearch" placeholder="Search friends...">
                </div>
                <div class="detailed-users-list" id="usersListContainer">
                    <!-- Reusing the same ID for simplicity in script.js logic update -->
                    <!-- Users will be populated here -->
                </div>
            </div>
        </div>
    </div>

    <!-- Image Crop Modal -->
    <div class="crop-modal" id="cropModal">
        <div class="crop-modal-content">
            <div class="crop-header">
                <h3><i class="fas fa-crop-alt"></i> CROP PHOTO</h3>
                <button class="crop-close" id="cropModalClose">
                    <i class="fas fa-times"></i>
                </button>
            </div>
            <div class="crop-body">
                <div class="crop-container">
                    <img id="cropImage" src="">
                </div>
                <div class="crop-preview-container">
                    <p>PREVIEW</p>
                    <div class="crop-preview"></div>
                </div>
            </div>
            <div class="crop-footer">
                <button id="cancelCropBtn" class="crop-cancel-btn">CANCEL</button>
                <button id="applyCropBtn" class="crop-apply-btn">APPLY CROP</button>
            </div>
        </div>
    </div>

    <!-- Upside Down Overlay -->
    <div class="upside-down-overlay" id="upsideDownOverlay">
        <div class="dust-particles" id="dustParticles"></div>
        <div class="flickering-light"></div>
    </div>

    <!-- Stranger Things Modal (GLOBAL) -->
    <div class="st-modal" id="stModal">
        <div class="st-overlay"></div>
        <div class="st-content">
            <div class="st-image-container" id="stImageContainer">
                <img src="/stranger-things-logo.png" class="st-logo">
            </div>
            <div class="st-video-container" id="stVideoContainer">
                <video id="stVideo" autoplay muted playsinline>
                    <source src="/st.mp4" type="video/mp4">
                </video>
            </div>
        </div>
    </div>



    <!-- Custom Error Popup -->
    <div class="custom-error-overlay" id="customErrorOverlay">
        <div class="custom-error-popup">
            <div class="error-icon">
                <i class="fas fa-exclamation-circle"></i>
            </div>
            <div class="error-title" id="errorTitle">Error</div>
            <div class="error-message" id="errorMessage"></div>
            <button class="error-ok-btn" onclick="hideCustomError()">
                <div class="btn-bg"></div>
                <span>OK</span>
            </button>
        </div>
    </div>

    <!-- Socket.IO -->
    <script src="https://cdn.socket.io/4.7.2/socket.io.min.js"></script>
    <script type="module" src="script.js?v=2.0"></script>
</body>

</html>